<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiveFPL Clone</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <main class="container">
        <section class="intro">
            <p>Welcome to LiveFPL! Here you can follow your FPL points, overall rank and minileague tables with live bonus and autosubs, all exactly processed in real-time. You can also understand which players may have the most effect on your rank.</p>
            <hr>
        </section>

        <section class="id-input-section">
            <div class="accent-title">
                <h2>Please Enter your FPL ID to get started!</h2>
            </div>
            <a href="#" class="help-link">How to get my FPL id?</a>

            <div class="form-group">
                <label for="fpl-id">ID</label>
                <input type="text" id="fpl-id" placeholder="Enter new ID">
                <button id="change-id-btn">Change ID</button>
            </div>
            <a href="#" class="help-link">How to get my FPL id?</a>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <h1 class="logo">LIVE<span>â–²</span>FPL</h1>
            <p class="tagline">Get free access to extra tools: Planner, Tracking Favorite Managers and more</p>
            
            <div class="footer-links">
                <div class="link-column">
                    <h3>Live Tools</h3>
                    <ul>
                        <li>Live Rank</li>
                        <li>Live Leagues</li>
                        <li>Live Games & Bonus</li>
                        <li>What if? Rank for all Scenarios</li>
                        <li>Live Auto-Subs</li>
                    </ul>
                </div>
                <div class="link-column">
                    <h3>Price Changes</h3>
                    <ul>
                        <li>Predictor</li>
                        <li>Actual Changes</li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 25px;
        }

        /* Card Styles */
        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            padding: 20px;
            margin-bottom: 25px;
        }

        h2 {
            margin-top: 0;
            font-size: 1.2rem;
            border-bottom: 2px solid var(--fpl-cyan);
            padding-bottom: 10px;
            color: var(--fpl-purple);
        }

        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            text-align: left;
            font-size: 0.8rem;
            color: #777;
            text-transform: uppercase;
            padding: 10px 5px;
        }

        td {
            padding: 12px 5px;
            border-bottom: 1px solid #eee;
            font-size: 0.95rem;
        }

        .pos-badge {
            font-weight: bold;
            font-size: 0.75rem;
            padding: 2px 6px;
            border-radius: 4px;
            background: #eee;
        }

        .player-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .player-img {
            width: 35px;
            height: 35px;
            background: #f0f0f0;
            border-radius: 50%;
        }

        .points-highlight {
            font-weight: bold;
            color: var(--fpl-pink);
        }

        /* Loading State */
        #loading {
            text-align: center;
            padding: 50px;
            font-style: italic;
        }

        @media (max-width: 800px) {
            .main-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>FPL Insight Dashboard</h1>
        <p>Real-time Fantasy Premier League Data</p>
    </header>

    <div id="loading">Fetching latest FPL data...</div>

    <div class="main-grid" id="dashboard" style="display: none;">
        <div class="content-area">
            <section class="card">
                <h2>Team of the Week (Top Scorers)</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Pos</th>
                            <th>Player</th>
                            <th>Points</th>
                        </tr>
                    </thead>
                    <tbody id="totw-list"></tbody>
                </table>
            </section>
        </div>

        <aside class="sidebar">
            <section class="card">
                <h2>Top 5 Most Valuable Teams</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Team</th>
                            <th>Strength</th>
                        </tr>
                    </thead>
                    <tbody id="teams-list"></tbody>
                </table>
            </section>

            <section class="card">
                <h2>Top 5 Leagues</h2>
                <table>
                    <thead>
                        <tr>
                            <th>League</th>
                            <th>Rating</th>
                        </tr>
                    </thead>
                    <tbody id="leagues-list">
                        <tr><td>Overall</td><td>High</td></tr>
                        <tr><td>Supporters</td><td>Med</td></tr>
                        <tr><td>Public</td><td>Med</td></tr>
                        <tr><td>H2H</td><td>High</td></tr>
                        <tr><td>Classic</td><td>High</td></tr>
                    </tbody>
                </table>
            </section>
        </aside>
    </div>
</div>

<script>
    // FPL API Endpoint via CORS Proxy
    const API_URL = "https://cors-anywhere.herokuapp.com/https://fantasy.premierleague.com/api/bootstrap-static/";

    async function fetchData() {
        try {
            const response = await fetch(API_URL);
            if (!response.ok) throw new Error("Proxy access required");
            
            const data = await response.json();
            
            renderTOTW(data.elements);
            renderValuableTeams(data.teams);
            
            document.getElementById('loading').style.display = 'none';
            document.getElementById('dashboard').style.display = 'grid';
        } catch (error) {
            document.getElementById('loading').innerHTML = `
                <div style="color: red;">
                    <h3>CORS Access Required</h3>
                    <p>FPL blocks direct browser requests. Please visit 
                    <a href="https://cors-anywhere.herokuapp.com/corsdemo" target="_blank">CORS Anywhere</a> 
                    and click "Request temporary access", then refresh this page.</p>
                </div>`;
        }
    }

    function renderTOTW(players) {
        const list = document.getElementById('totw-list');
        
        // Sorting players to find the dream team (4-4-2 format)
        const gk = players.filter(p => p.element_type === 1).sort((a,b) => b.event_points - a.event_points).slice(0, 1);
        const def = players.filter(p => p.element_type === 2).sort((a,b) => b.event_points - a.event_points).slice(0, 4);
        const mid = players.filter(p => p.element_type === 3).sort((a,b) => b.event_points - a.event_points).slice(0, 4);
        const fwd = players.filter(p => p.element_type === 4).sort((a,b) => b.event_points - a.event_points).slice(0, 2);

        const best11 = [...gk, ...def, ...mid, ...fwd];
        const posLabels = ["GK", "DEF", "DEF", "DEF", "DEF", "MID", "MID", "MID", "MID", "FWD", "FWD"];

        best11.forEach((player, i) => {
            const row = `
                <tr>
                    <td><span class="pos-badge">${posLabels[i]}</span></td>
                    <td>
                        <div class="player-row">
                            <img class="player-img" src="https://resources.premierleague.com/premierleague/photos/players/40x40/p${player.code}.png" onerror="this.src='https://via.placeholder.com/40'">
                            <span>${player.web_name}</span>
                        </div>
                    </td>
                    <td class="points-highlight">${player.event_points}</td>
                </tr>
            `;
            list.innerHTML += row;
        });
    }

    function renderValuableTeams(teams) {
        const list = document.getElementById('teams-list');
        // Sorting teams by strength/value
        const topTeams = [...teams].sort((a,b) => b.strength - a.strength).slice(0, 5);

        topTeams.forEach(team => {
            list.innerHTML += `
                <tr>
                    <td><strong>${team.name}</strong></td>
                    <td>${team.strength}</td>
                </tr>
            `;
        });
    }

    // Initialize
    fetchData();
</script>

</body>
</html>
